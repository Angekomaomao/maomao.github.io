# Vercel部署文件清单

## 必须上传到GitHub的文件

### 1. vercel.json（根目录）
这是Vercel的配置文件，告诉Vercel如何部署你的应用。

**位置：** 项目根目录
**文件：** `vercel.json`

### 2. api/data.js（新建api文件夹）
这是后端API函数，处理数据的读取和保存。

**位置：** 创建 `api` 文件夹，在里面放 `data.js`
**文件：** `api/data.js`

### 3. 更新后的server.js
为了兼容Vercel，需要更新server.js文件。

**位置：** 项目根目录
**文件：** `server.js`

## 上传步骤

### 方法1：GitHub网页上传

1. 进入你的GitHub仓库
2. 点击 `Add file` → `Upload files`
3. 将以下文件拖拽上传：
   - `vercel.json`
   - `server.js`（更新版）
4. 创建api文件夹：
   - 点击 `Add file` → `Create new file`
   - 文件名输入：`api/data.js`
   - 粘贴 data.js 的内容
   - 点击 `Commit new file`
5. 提交说明填写：`添加Vercel部署配置`

### 方法2：逐个文件上传

#### 上传 vercel.json
1. 点击 `Add file` → `Create new file`
2. 文件名：`vercel.json`
3. 复制以下内容并粘贴：

```json
{
  "version": 2,
  "builds": [
    {
      "src": "api/**/*.js",
      "use": "@vercel/node"
    },
    {
      "src": "留言web/**",
      "use": "@vercel/static"
    }
  ],
  "routes": [
    {
      "src": "/api/(.*)",
      "dest": "/api/$1"
    },
    {
      "src": "/(.*)",
      "dest": "/留言web/$1"
    }
  ]
}
```

4. 点击 `Commit new file`

#### 上传 api/data.js
1. 点击 `Add file` → `Create new file`
2. 文件名：`api/data.js`（会自动创建api文件夹）
3. 复制以下内容并粘贴：

```javascript
// Vercel Serverless Function
let dataStore = {
    messages: [],
    folders: []
};

module.exports = async (req, res) => {
    res.setHeader('Access-Control-Allow-Credentials', true);
    res.setHeader('Access-Control-Allow-Origin', '*');
    res.setHeader('Access-Control-Allow-Methods', 'GET,POST,OPTIONS');
    res.setHeader('Access-Control-Allow-Headers', 'Content-Type');

    if (req.method === 'OPTIONS') {
        res.status(200).end();
        return;
    }

    if (req.method === 'GET') {
        res.status(200).json(dataStore);
    } else if (req.method === 'POST') {
        try {
            dataStore = req.body;
            res.status(200).json({ success: true, message: '数据保存成功' });
        } catch (error) {
            res.status(500).json({ error: '数据保存失败' });
        }
    } else {
        res.status(405).json({ error: 'Method not allowed' });
    }
};
```

4. 点击 `Commit new file`

## 上传后

1. 文件上传到GitHub后，Vercel会自动重新部署
2. 等待1-2分钟
3. 访问你的网址测试

## 验证部署是否成功

在浏览器中访问：
- 主页：`https://你的域名.vercel.app`
- API测试：`https://你的域名.vercel.app/api/data`

如果API测试返回JSON数据（例如 `{"messages":[],"folders":[]}`），说明部署成功！
